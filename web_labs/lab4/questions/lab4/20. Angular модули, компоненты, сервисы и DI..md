### Введение

Angular – это комплексный фреймворк, где все элементы тесно связаны. Основные строительные блоки – **Модули**, **Компоненты** и **Сервисы**, а их взаимодействие происходит благодаря **Dependency Injection (DI)**.

---

### 1. Модули (NgModule)

- **Что это:** Блок, который группирует связанные компоненты, директивы, пайпы и сервисы. Это способ организации вашего приложения.
    
- **Зачем:**
    
    - **Организация:** Разделяет приложение на логические функциональные части.
        
    - **Компиляция:** Помогает Angular компилировать и оптимизировать приложение.
        
    - **Ленивая загрузка (Lazy Loading):** Позволяет загружать модули только тогда, когда они нужны, ускоряя начальную загрузку приложения.
        
- **Структура @NgModule:**
    
    - **declarations:** Компоненты, директивы и пайпы, принадлежащие этому модулю.
        
    - **imports:** Другие модули, необходимые для работы этого модуля (например, BrowserModule, FormsModule, HttpClientModule, другие кастомные модули).
        
    - **providers:** Сервисы, которые будут доступны для этого модуля и его потомков (через DI).
        
    - **exports:** Компоненты, директивы, пайпы и сервисы, которые этот модуль предоставляет для использования другими модулями.
        
    - **bootstrap:** Корневой компонент приложения (только в корневом модуле, обычно AppModule), который Angular монтирует в DOM.
        
- **Пример (AppModule):**
    
    
    ```typescript
    import { NgModule } from '@angular/core';
    import { BrowserModule } from '@angular/platform-browser'; // Модуль для браузерных приложений
    import { HttpClientModule } from '@angular/common/http'; // Модуль для HTTP-запросов
    
    import { AppComponent } from './app.component'; // Корневой компонент
    import { UserListComponent } from './user-list/user-list.component'; // Другой компонент
    import { UserService } from './services/user.service'; // Сервис
    
    @NgModule({
      declarations: [ // Что принадлежит этому модулю
        AppComponent,
        UserListComponent
      ],
      imports: [ // Другие модули, которые нужны здесь
        BrowserModule,
        HttpClientModule,
        // ... другие модули
      ],
      providers: [ // Сервисы, которые будут доступны
        UserService
      ],
      bootstrap: [AppComponent] // Какой компонент запускается первым
    })
    export class AppModule { }
    ```
    

---

### 2. Компоненты (Component)

- **Что это:** Основной строительный блок UI в Angular. Каждый компонент управляет частью DOM.
    
- **Структура компонента:**
    
    1. **Класс TypeScript (.ts):** Содержит логику, данные (свойства) и методы.
        
    2. **HTML-шаблон (.html):** Определяет структуру UI.
        
    3. **CSS-стили (.css, .scss, etc.):** Определяют внешний вид. Angular обеспечивает **изоляцию стилей** по умолчанию.
        
- **Декоратор @Component:**
    
    - Прикрепляется к классу TypeScript.
        
    - Определяет метаданные компонента:
        
        - selector: Уникальный HTML-тег для этого компонента (например, app-user-list).
            
        - templateUrl / template: Путь к файлу шаблона или сам шаблон.
            
        - styleUrls / styles: Пути к файлам стилей или сами стили.
            
- **Пример (user-list.component.ts):**
    
    
    ```typescript
    import { Component, OnInit } from '@angular/core';
    import { UserService } from '../services/user.service'; // Сервис, который будет внедрен
    
    @Component({
      selector: 'app-user-list', // Как использовать этот компонент в другом шаблоне: <app-user-list></app-user-list>
      templateUrl: './user-list.component.html', // HTML-шаблон
      styleUrls: ['./user-list.component.css'] // CSS-стили
    })
    export class UserListComponent implements OnInit { // implements OnInit - означает, что класс реализует интерфейс OnInit
      users: any[] = []; // Свойство для хранения списка пользователей (any - для простоты, лучше использовать интерфейс)
    
      // DI: Angular внедряет UserService в конструктор
      constructor(private userService: UserService) { }
    
      // Метод жизненного цикла: вызывается после инициализации компонента
      ngOnInit(): void {
        this.loadUsers(); // Загружаем пользователей при инициализации
      }
    
      loadUsers(): void {
        this.userService.getUsers().subscribe(data => { // Подписываемся на Observable от сервиса
          this.users = data; // Обновляем свойство users
        });
      }
    }
    ```
    

---

### 3. Сервисы (Service)

- **Что это:** Классы TypeScript, предназначенные для инкапсуляции **бизнес-логики, доступа к данным, работы с API**, или любой другой функциональности, которая не связана напрямую с UI.
    
- **Зачем:**
    
    - **Переиспользование кода:** Логика, используемая в нескольких компонентах, выносится в сервис.
        
    - **Разделение ответственности:** Компоненты сосредоточены на UI, сервисы – на логике.
        
    - **Тестируемость:** Сервисы легко тестировать изолированно.
        
    - **Централизация данных:** Сервисы могут хранить состояние, доступное разным компонентам.
        
- **Декоратор @Injectable:**
    
    - Помечает класс как сервис, который может быть внедрен в другие компоненты или сервисы.
        
    - @Injectable({ providedIn: 'root' }) – это самый распространенный способ регистрации сервиса. Он делает сервис доступным во всем приложении (как синглтон) без необходимости явно добавлять его в providers корневого модуля.
        
- **Пример (user.service.ts):**
    
    
    ```typescript
    import { Injectable } from '@angular/core';
    import { HttpClient } from '@angular/common/http'; // Сервис для HTTP-запросов
    import { Observable } from 'rxjs'; // RxJS Observable
    
    @Injectable({
      providedIn: 'root' // Сервис будет предоставлен глобально (синглтон)
    })
    export class UserService {
      private apiUrl = 'https://jsonplaceholder.typicode.com/users'; // URL API
    
      // DI: Angular внедряет HttpClient в конструктор
      constructor(private http: HttpClient) { }
    
      getUsers(): Observable<any[]> { // Метод возвращает Observable
        return this.http.get<any[]>(this.apiUrl); // Выполняем GET-запрос
      }
    
      getUserById(id: number): Observable<any> {
        return this.http.get<any>(`${this.apiUrl}/${id}`);
      }
    }
    ```
    

---

### 4. Dependency Injection (DI)

- **Что это:** **Принцип проектирования**, который Angular использует для управления зависимостями. Вместо того, чтобы класс сам создавал свои зависимости, они "внедряются" ему извне.
    
- **Зачем:**
    
    - **Слабая связанность:** Компоненты и сервисы не привязаны к конкретной реализации своих зависимостей.
        
    - **Тестируемость:** Легко подменить реальные зависимости на "моки" (mock-объекты) при написании тестов.
        
    - **Переиспользование:** Сервисы, предоставленные через DI, могут быть синглтонами, обеспечивая общее состояние и логику.
        
    - **Читаемость:** Четко видно, какие зависимости использует класс.
        
- **Как работает:**
    
    1. **Провайдеры (Providers):** Вы регистрируете "провайдера" для сервиса. Это может быть сделано:
        
        - В @NgModule({ providers: [...] }).
            
        - В @Component({ providers: [...] }) (сервис будет доступен только для этого компонента и его потомков).
            
        - При помощи @Injectable({ providedIn: 'root' }) (самый простой способ для глобальных сервисов).
            
    2. **Внедрение (Injection):** Вы объявляете зависимость в конструкторе класса (компонента или сервиса), указывая тип зависимости.
        
        codeTypeScript
        
        ```
        // Компонент или сервис, который нуждается в UserService
        constructor(private myUserService: UserService) {
          // myUserService теперь является экземпляром UserService
        }
        ```
        
        Angular DI-система находит провайдера для UserService и передает соответствующий экземпляр в конструктор.
        

---

### Краткий итог:

- **Модули (NgModule)** – организуют приложение на блоки.
    
- **Компоненты (Component)** – строят UI (логика .ts, шаблон .html, стили .css).
    
- **Сервисы (Service)** – содержат общую логику и данные (.ts с @Injectable).
    
- **Dependency Injection (DI)** – механизм, который позволяет компонентам и сервисам получать нужные им зависимости (сервисы), делая код модульным, тестируемым и переиспользуемым.