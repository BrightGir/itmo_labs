## 1. JSF-компоненты

**JSF-компонент** — это не просто HTML-тег. Это полноценный **серверный Java-объект**, который хранит свое состояние (значение, видимость, доступность), имеет привязанные к нему валидаторы, конвертеры и слушатели событий. Все компоненты на странице образуют на сервере древовидную структуру — **дерево компонентов (Component Tree)**.

### Особенности реализации

1.  **Разделение Модели и Представления**: Каждый компонент имеет:
    *   **Собственно компонент (Component)**: Java-объект, отвечающий за состояние и поведение.
    *   **Отрисовщик (Renderer)**: Класс, отвечающий за генерацию HTML-разметки для этого компонента. Это позволяет одному и тому же компоненту (например, календарю) выглядеть по-разному в зависимости от того, какой Renderer Kit используется (например, один для десктопных браузеров, другой для мобильных).

2.  **Состояние (Stateful)**: Компоненты сохраняют свое состояние между запросами. Если пользователь ввел текст в поле, JSF запомнит этот текст при следующей отправке формы.

3.  **Декларативное объявление**: Компоненты объявляются на странице (в `.xhtml` файлах) с помощью специальных тегов, например `<h:inputText>`, `<h:commandButton>`.

### Иерархия классов

Все UI-компоненты JSF наследуются от базового класса `javax.faces.component.UIComponent`. Его реализация по умолчанию — `UIComponentBase`.

Основные ветви иерархии:

-   `UIComponent`
    -   `UIOutput`: Компоненты для вывода информации.
        -   `HtmlOutputText`: Отображает текст (`<h:outputText>`).
        -   `HtmlOutputLabel`: Метка для другого компонента (`<h:outputLabel>`).
    -   `UIInput`: Компоненты для ввода данных, наследуются от `UIOutput` и добавляют функциональность обработки и валидации ввода.
        -   `HtmlInputText`: Текстовое поле (`<h:inputText>`).
        -   `HtmlInputSecret`: Поле для пароля (`<h:inputSecret>`).
        -   `HtmlInputTextarea`: Многострочное текстовое поле (`<h:inputTextarea>`).
    -   `UICommand`: Компоненты для выполнения действий (отправка формы, вызов методов).
        -   `HtmlCommandButton`: Кнопка (`<h:commandButton>`).
        -   `HtmlCommandLink`: Ссылка (`<h:commandLink>`).
    -   `UIPanel`: Компоненты-контейнеры для группировки других компонентов.
        -   `HtmlPanelGrid`: Табличный контейнер (`<h:panelGrid>`).
        -   `HtmlPanelGroup`: Простой `<span>` или `<div>` контейнер (`<h:panelGroup>`).
    -   `UISelectOne`: Компоненты для выбора одного элемента.
        -   `HtmlSelectOneMenu`: Выпадающий список (`<h:selectOneMenu>`).
        -   `HtmlSelectOneRadio`: Группа радиокнопок (`<h:selectOneRadio>`).
    -   `UISelectMany`: Компоненты для выбора нескольких элементов.
        -   `HtmlSelectManyCheckbox`: Группа чекбоксов (`<h:selectManyCheckbox>`).
        -   `HtmlSelectManyListbox`: Список с множественным выбором (`<h:selectManyListbox>`).

---

## 2. Дополнительные библиотеки компонентов

Стандартный набор JSF-компонентов довольно прост. Для создания современных и богатых интерфейсов используются сторонние библиотеки:

-   **PrimeFaces**: **Самая популярная** и мощная библиотека. Предоставляет огромное количество готовых виджетов: продвинутые таблицы с сортировкой и фильтрацией, графики, календари, загрузчики файлов, диалоговые окна и многое другое. Сильно интегрирована с AJAX.

-   **RichFaces**: Исторически одна из первых крупных библиотек, известная своей мощной поддержкой AJAX. В настоящее время ее развитие замедлилось, но она все еще используется в legacy-проектах.

-   **ICEfaces**: Еще одна крупная библиотека, фокусирующаяся на технологиях автоматического обновления страниц (Ajax Push) для создания динамичных приложений.

-   **OmniFaces**: Это не библиотека виджетов, а **библиотека-утилита** для JSF. Она предоставляет множество полезных функций, компонентов и слушателей, которые решают распространенные проблемы и упрощают разработку на "чистом" JSF. Настоятельно рекомендуется для любого серьезного проекта.

---

## 3. Модель обработки событий в JSF

Модель событий в JSF похожа на ту, что используется в десктопных GUI-фреймворках (например, Swing). Действия пользователя в браузере (клик, изменение значения) генерируют события, которые обрабатываются **на сервере**.

### Типы событий

1.  **`ActionEvent` (Событие действия)**
    -   **Источник**: Компоненты `UICommand` (кнопки, ссылки).
    -   **Когда возникает**: Когда пользователь нажимает на кнопку или ссылку.
    -   **Назначение**: Выполнение бизнес-логики, навигация.

2.  **`ValueChangeEvent` (Событие изменения значения)**
    -   **Источник**: Компоненты `UIInput` (поля ввода, чекбоксы, списки).
    -   **Когда возникает**: Когда пользователь изменяет значение в поле и отправляет форму (или при потере фокуса, если используется AJAX).
    -   **Назначение**: Реакция на изменение данных (например, показать/скрыть другое поле, пересчитать сумму).

3.  **`SystemEvent` (Системное событие)**
    -   **Источник**: Сам фреймворк JSF.
    -   **Когда возникает**: В различные моменты жизненного цикла JSF (например, `PreRenderViewEvent` — перед тем, как страница будет отрисована).
    -   **Назначение**: Выполнение логики, привязанной к жизненному циклу (например, проверка прав доступа перед показом страницы).

### Обработка событий

События связываются с методами в управляемых бинах (Managed Beans) через атрибуты в XHTML-тегах.

**Пример обработки `ActionEvent`:**

```xml
<h:form>
    <!-- 1. Метод-обработчик для бизнес-логики -->
    <h:commandButton value="Save" actionListener="#{userBean.saveListener}" />

    <!-- 2. Метод для навигации -->
    <h:commandButton value="Go to Profile" action="#{userBean.showProfile}" />
</h:form>
```

**Соответствующий Java-код в UserBean.java:**

```java
@ManagedBean
@RequestScoped
public class UserBean {

    // Метод для actionListener, принимает ActionEvent
    public void saveListener(ActionEvent event) {
        // Логика сохранения данных...
        // event.getComponent() позволяет получить доступ к компоненту, вызвавшему событие
        System.out.println("Save button clicked!");
    }

    // Метод для action, возвращает строку для навигации
    public String showProfile() {
        // Загрузка данных профиля...
        return "profile?faces-redirect=true"; // Переход на страницу profile.xhtml
    }
}
```

- actionListener: Используется для выполнения кода **без** изменения навигации. Метод должен иметь сигнатуру void methodName(ActionEvent event).
    
- action: Используется в первую очередь для навигации. Метод возвращает String — логическое имя страницы, на которую нужно перейти. Если метод возвращает null или void, навигации не происходит.
    

### AJAX и события

С помощью тега <f:ajax> можно отправлять события на сервер без перезагрузки всей страницы.


```xml
<h:inputText value="#{userBean.username}">
    <f:ajax event="keyup" render="usernameMessage" />
</h:inputText>

<h:outputText id="usernameMessage" value="#{userBean.usernameStatus}" />
```

В этом примере каждое нажатие клавиши (keyup) в поле ввода будет отправлять AJAX-запрос на сервер, а затем обновлять только компонент с id="usernameMessage".

